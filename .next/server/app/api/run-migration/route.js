"use strict";(()=>{var e={};e.id=328,e.ids=[328],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},55073:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>T,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var s={};t.r(s),t.d(s,{POST:()=>p});var n=t(49303),o=t(88716),i=t(60670),a=t(87070),u=t(1926);async function p(){let e=(0,u.uw)();try{let{data:r,error:t}=await e.rpc("exec",{query:`
        CREATE TABLE IF NOT EXISTS public.password_resets (
          id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
          email TEXT NOT NULL,
          otp TEXT NOT NULL,
          reset_token TEXT,
          expires_at TIMESTAMPTZ NOT NULL,
          reset_token_expires_at TIMESTAMPTZ,
          created_at TIMESTAMPTZ DEFAULT NOW(),
          CONSTRAINT unique_email_reset UNIQUE (email)
        );

        -- Add index for faster lookups
        CREATE INDEX IF NOT EXISTS idx_password_resets_email ON public.password_resets (email);
        CREATE INDEX IF NOT EXISTS idx_password_resets_reset_token ON public.password_resets (reset_token);
      `});if(t)return a.NextResponse.json({success:!1,error:"Error running migration",details:t.message},{status:500});return a.NextResponse.json({success:!0,message:"Migration completed successfully",data:r})}catch(e){return a.NextResponse.json({success:!1,error:"Unexpected error",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let c=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/run-migration/route",pathname:"/api/run-migration",filename:"route",bundlePath:"app/api/run-migration/route"},resolvedPagePath:"/Users/anonymous/Downloads/xmas-tree/src/app/api/run-migration/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:m}=c,x="/api/run-migration/route";function T(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},1926:(e,r,t)=>{t.d(r,{fU:()=>u,pR:()=>c,uw:()=>p});var s=t(86718),n=t(71615);let o="https://nyykggssyasvxrtjhhhb.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im55eWtnZ3NzeWFzdnhydGpoaGhiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUwMjM5NDksImV4cCI6MjA3MDU5OTk0OX0.60hkCLL76yg0Bg9-W-le06lHnSwadeU74-xEpRPAqug",a=process.env.SUPABASE_SERVICE_ROLE_KEY;function u(){let e=(0,n.cookies)();return(0,s.createServerClient)(o,i,{cookies:{get:r=>e.get(r)?.value}})}function p(){let e=(0,n.cookies)();return(0,s.createServerClient)(o,a,{cookies:{get:r=>e.get(r)?.value}})}(0,s.createBrowserClient)(o,i);let c=(0,s.createServerClient)(o,a,{cookies:{get:()=>""}})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,219,70],()=>t(55073));module.exports=s})();